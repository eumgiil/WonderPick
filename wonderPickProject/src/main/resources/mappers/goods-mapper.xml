<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper
  PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN"
  "https://mybatis.org/dtd/mybatis-3-mapper.dtd">
  
  <mapper namespace="goodsMapper">
  
  <resultMap id="goodsResultSet" type="goods">
  	<result column="board_no" property="boardNo" />
  	<result column="price" property="price" />
  	<result column="draft" property="draft" />
  	<result column="modify_count" property="modifyCount" />
  	<result column="workday" property="workday" />
  	<result column="add_draft" property="addDraft" />
  	<result column="add_modify" property="addModify" />
  	<result column="amount" property="amount" />
  	<result column="goods_category" property="goodsCategory" />
  	<result column="add_info" property="addInfo" />
  	<result column="member_no" property="memberNo" />
  	<result column="board_title" property="boardTitle" />
  	<result column="board_content" property="boardContent" />
  	<result column="create_date" property="createDate" />
  	<result column="board_count" property="boardCount" />
  	<result column="nickname" property="nickName" />
  </resultMap>
  
  
  <select id="selectListCount" resultType="_int">
	 select
            count(*)
     from
            board
	  where
	        status = 'Y'
	  and
	       board_type = 'G'
  </select>
  <select id="selectGoodsList" resultMap="goodsResultSet">
select
       board_no, 
       board_title, 
       nickname, 
       board_count,
       to_char(create_date, 'YYYY-MM-DD') as "create_date" ,
       price,
       origin_name
  from 
       board b
 join 
      member using (member_no)
 join 
 	 board_image using (board_no)
 join goods using(board_no)
 where
     b.status = 'Y'
and 
    board_type ='G'
order by
      board_no asc
  </select>
  
  <insert id="insertBoard" parameterType="board">
  insert
     into
         board
          (
          board_no,
          member_no,
          board_title,
          board_content,
          board_type
          )
     values
          (
          seq_board_no.nextval,
          #{memberNo},
          #{boardTitle},
          #{boardContent},
          'G'
          )
  </insert>
  
  <insert id="insertGoods" parameterType="goods">
  insert
  into 
      goods
      (
      board_no,
      price,
      draft,
      modify_count,
      workday,
      add_draft,
      add_modify,
      goods_category
      )
 values
      (
      seq_board_no.currval,
      #{boardNo},
      #{price},
      #{draft},
      #{modifyCount},
      #{workday},
      #{addDraft},
      #{addModify},
      #{goodsCategory}
      )
  </insert>
  <insert id="insertBoardImage" parameterType="boardImage">
  insert 
    into
        boardImage
      (
      board_image_no,
      board_no,
      origin_name,
      modify_name
      )
   values
   (
   seq_boardImg_no.nextval,
   seq_board_no.currval,
   #{originName},
   #{modifyName}
   )
  </insert>
  <update id="increaseCount">
  update
        board
   set
       board_count =  board_count + 1
  where
        board_no = #{boardNo}
    and
        status = 'Y'
  </update>
  <select id="selectGoods" resultMap="goodsResultSet">
  select
  		nickname,
  		board_title,
  		board_content,
      	price,
      	draft,
      	modify_count,
      	workday,
      	add_draft,
      	add_modify,
      	goods_category
 from goods
 join board using (board_no)
 join member using(member_no)
 where board_no = #{boardNo}
  </select>

  
  



</mapper>

